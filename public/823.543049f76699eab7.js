"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[823],{7823:(y,u,r)=>{r.r(u),r.d(u,{ProjectCreateModule:()=>F});var c=r(6895),d=r(5412),e=r(4650),C=r(1458),j=r(1491),v=r(9299),g=r(4859),s=r(4006),l=r(9549),h=r(4144),P=r(7392),m=r(1572);function x(n,i){if(1&n&&(e.TgZ(0,"code"),e._uU(1),e.qZA()),2&n){const t=i.$implicit,o=i.index;e.xp6(1),e.AsE("",o?", ":"","",t,"")}}function Z(n,i){1&n&&e._UZ(0,"mat-spinner",11),2&n&&e.Q6J("diameter",30)}let M=(()=>{class n{constructor(t,o,a,p,f){this.dialogRef=t,this.data=o,this.helper=a,this.apiService=p,this.router=f,this.projectName="",this.creating=!1,this.gettingBranches=!1,this.branches=[]}ngOnInit(){this.projectName=this.data.repo.full_name,this.getBranches()}create(){this.creating=!0,this.dialogRef.disableClose=!0,this.apiService.post("proj/create",{repo:this.data.repo,project_name:this.projectName}).subscribe({next:t=>{this.creating=!1,this.dialogRef.disableClose=!1,t.status?(this.router.navigate(["project",this.helper.encode(t.data.project_id)]),this.helper.emit({name:"projectCreate",data:{id:t.data.project_id}}),this.dialogRef.close()):this.helper.alertError(t)},error:t=>{this.creating=!1,this.dialogRef.disableClose=!1,this.helper.alertError(t)}})}getBranches(){this.gettingBranches=!0,this.apiService.post("repo/git/branches",{account_id:this.data.repo.account_id,full_name:this.data.repo.full_name}).subscribe({next:t=>{this.gettingBranches=!1,t.status?this.branches=t.data.branches:this.helper.alertError(t)},error:t=>{this.gettingBranches=!1,this.helper.alertError(t)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.so),e.Y36(d.WI,8),e.Y36(C.W),e.Y36(j.s),e.Y36(v.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-project-create-confirm"]],decls:23,vars:5,consts:[[2,"padding","25px"],[2,"margin-top","0"],[2,"min-width","400px","margin-bottom","30px"],[2,"color","#777"],["appearance","outline",2,"width","100%"],["matInput","",3,"ngModel","ngModelChange"],[2,"margin-top","0px","margin-bottom","5px"],[4,"ngFor","ngForOf"],[3,"diameter",4,"ngIf"],[2,"font-size","17px","height","18px","line-height","14px","vertical-align","middle","width","20px","color","#444"],["type","button","mat-flat-button","","color","primary",3,"disabled","click"],[3,"diameter"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Create Project"),e.qZA(),e.TgZ(3,"p",2)(4,"span",3),e._uU(5,"Project location"),e.qZA(),e._UZ(6,"br"),e._uU(7),e.qZA(),e.TgZ(8,"mat-form-field",4)(9,"mat-label"),e._uU(10,"Project name"),e.qZA(),e.TgZ(11,"input",5),e.NdJ("ngModelChange",function(p){return o.projectName=p}),e.qZA()(),e.TgZ(12,"p",6),e._uU(13," Available branches: "),e.qZA(),e.YNc(14,x,2,2,"code",7),e.YNc(15,Z,1,1,"mat-spinner",8),e.TgZ(16,"p")(17,"small")(18,"mat-icon",9),e._uU(19,"info "),e.qZA(),e._uU(20," Web hooks will be created for this project "),e.qZA()(),e.TgZ(21,"button",10),e.NdJ("click",function(){return o.create()}),e._uU(22," Create "),e.qZA()()),2&t&&(e.xp6(7),e.hij(" ",o.data.repo.clone_url," "),e.xp6(4),e.Q6J("ngModel",o.projectName),e.xp6(3),e.Q6J("ngForOf",o.branches),e.xp6(1),e.Q6J("ngIf",o.gettingBranches),e.xp6(6),e.Q6J("disabled",o.creating||!o.projectName))},dependencies:[c.sg,c.O5,g.lW,s.Fj,s.JJ,s.On,l.KE,l.hX,h.Nt,P.Hw,m.Ou]}),n})();function T(n,i){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"mat-spinner",5),e.qZA()),2&n&&(e.xp6(1),e.Q6J("diameter",50))}function _(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"span",12),e._uU(2),e.qZA(),e.TgZ(3,"button",13),e.NdJ("click",function(){const p=e.CHM(t).$implicit,f=e.oxw(2);return e.KtG(f.create(p))}),e._uU(4," Create "),e.qZA(),e._uU(5),e.TgZ(6,"span",14),e._uU(7),e.qZA()()}if(2&n){const t=i.$implicit;e.xp6(2),e.hij("(",t.size,")"),e.xp6(3),e.hij(" ",t.full_name," "),e.xp6(2),e.Oqu(t.provider)}}function O(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",6)(1,"mat-form-field",7)(2,"mat-label"),e._uU(3,"Filter"),e.qZA(),e.TgZ(4,"input",8),e.NdJ("ngModelChange",function(a){e.CHM(t);const p=e.oxw();return e.KtG(p.filterTerm=a)}),e.qZA()(),e.TgZ(5,"div",9),e.YNc(6,_,8,3,"div",10),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.filterTerm),e.xp6(2),e.Q6J("ngForOf",t.getFilteredRepos())}}let b=(()=>{class n{constructor(t,o,a,p){this.helper=t,this.apiService=o,this.fb=a,this.dialog=p,this.loading=!1,this.repos=[],this.filterTerm=""}ngOnInit(){this.loadRepos(),this.helper.setPage("project-create")}create(t){let o=this.dialog.open(M,{data:{repo:t}});return o.afterClosed().subscribe({next:a=>{console.log(a)}}),o}getFilteredRepos(){return this.repos.filter(t=>-1!=t.full_name.toLowerCase().indexOf(this.filterTerm.toLowerCase()))}loadRepos(){this.loading=!0,this.apiService.post("repo/git/all-repos",{}).subscribe({next:t=>{this.loading=!1,t.status?this.repos=t.data.repos.map(o=>(o.size=this.helper.bytes(o.size,2),o)):this.helper.alertError(t)},error:t=>{this.loading=!1,this.helper.alertError(t)}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.W),e.Y36(j.s),e.Y36(s.qu),e.Y36(d.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-project-create"]],decls:7,vars:2,consts:[[2,"height","15px"],[1,"page"],["class","loading",4,"ngIf"],["style","padding-top: 26px;",4,"ngIf"],[1,"loading"],[3,"diameter"],[2,"padding-top","26px"],["appearance","outline"],["matInput","",3,"ngModel","ngModelChange"],[1,"ps-c"],["class","ps-i",4,"ngFor","ngForOf"],[1,"ps-i"],[1,"ps-s"],["type","button","color","primary","mat-flat-button","",3,"click"],[1,"ps-p"]],template:function(t,o){1&t&&(e._UZ(0,"div",0),e.TgZ(1,"div",1)(2,"h2"),e._uU(3," New Project "),e.qZA(),e.TgZ(4,"div"),e.YNc(5,T,2,1,"div",2),e.YNc(6,O,7,2,"div",3),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngIf",o.repos.length))},dependencies:[c.sg,c.O5,g.lW,s.Fj,s.JJ,s.On,l.KE,l.hX,h.Nt,m.Ou],styles:[".ps-c[_ngcontent-%COMP%]{position:relative}.ps-c[_ngcontent-%COMP%]   .ps-i[_ngcontent-%COMP%]{padding:20px 0;border-top:solid 1px #ddd}.ps-c[_ngcontent-%COMP%]   .ps-i[_ngcontent-%COMP%]   span.ps-s[_ngcontent-%COMP%]{float:right}.ps-c[_ngcontent-%COMP%]   .ps-i[_ngcontent-%COMP%]   .ps-p[_ngcontent-%COMP%]{color:#807f7f;padding:6px 12px;border-radius:50px;margin-left:17px;font-weight:700}.ps-c[_ngcontent-%COMP%]   .ps-i[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:10px;opacity:0;transition:opacity .2s}.ps-c[_ngcontent-%COMP%]   .ps-i[_ngcontent-%COMP%]:hover   button[_ngcontent-%COMP%]{opacity:1}.loading[_ngcontent-%COMP%]{padding:50px 0}"]}),n})();var A=r(3546),N=r(3238),U=r(4385);let J=[{path:"project/create",component:b}],F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,v.Bz.forChild(J),A.QW,g.ot,s.u5,s.UX,l.lN,h.c,P.Ps,N.Ng,U.LD,m.Cq,d.Is]}),n})()}}]);