<div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div project-sidebar page="page"></div>
            </div>
            <div>
                <div class="col-md-9">
                    <div class="panel panel-card">

                        <div class="panel-body p-70" ng-if="loading">
                            <div class="loader" style="width: 60px">
                                <svg class="circular" viewBox="25 25 50 50">
                                    <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="3"
                                            stroke-miterlimit="10"/>
                                </svg>
                            </div>
                        </div>

                        <div class="panel-body" ng-if="!loading">
                            <h3 class=" m-t-5">
                                Deploy to {{server.name}}
                            </h3>
                            <div class="m-b-20">
                                from <img src="assets/img/branch.svg" style="height: 12px" alt=""> {{server.branch}}
                            </div>
                            <form name="form" ng-submit="newServer()">
                                <hr>
                                
                                <div class="alert alert-info alert-dismissible" role="alert"  ng-if="!server.revision">
                                    <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    This server is not deployed yet.
                                    Therefore update to latest and revert to revision options are disabled. <br>
                                    Please continue with your first fresh upload
                                </div>
                                <h4>
                                    Deployment type
                                </h4>
                                <div class="md-form-group no-p-t p-b-10">
                                    <div>
                                        <div class="radio inline radio-buttons m-r-10" ng-class="{disabled: !server.revision}">
                                            <label class="ui-checks">
                                                <input type="radio" ng-disabled="!server.revision" ng-model="deploy.type" name="deploy_type" value="2" ng-change="typeChange()">
                                                <i></i>
                                                update to latest
                                            </label>
                                        </div>
                                        <div class="radio inline radio-buttons m-r-10" ng-class="{disabled: !server.revision}">
                                            <label class="ui-checks">
                                                <input type="radio" ng-disabled="!server.revision" ng-model="deploy.type" name="deploy_type" value="4" ng-change="typeChange()">
                                                <i></i>
                                                Revert to revision
                                            </label>
                                        </div>
                                        <div class="radio inline radio-buttons m-r-10">
                                            <label class="ui-checks">
                                                <input type="radio" ng-model="deploy.type" name="deploy_type" value="3" ng-change="typeChange()">
                                                <i></i>
                                                Fresh upload
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <p ng-if="deploy.type == 3">
                                   <i class="zmdi zmdi-info-outline zmdi-hc-fw"></i> All files will be uploaded to the server. Files will be updated if it already exists.
                                </p>

                                <div>
                                    <div class="row">
                                        <div class="col-md-8" ng-if="server.type == 1 || server.type == 2">
                                            <div class="row" ng-if="server.type == 1">
                                                <div class="col-md-12">
                                                    <label class="md-check p-b-15">
                                                        <input type="checkbox" ng-model="server.secure">
                                                        <i class="bg-success white"></i>
                                                        Use FTP over TLS (FTPS) (recommended)
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="md-form-group">
                                                        <input class="md-input" ng-model="server.host" required>
                                                        <label>Host</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="md-form-group">
                                                        <input class="md-input" name="port" ng-model="server.port" required>
                                                        <label>Port</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="md-form-group">
                                                        <input class="md-input" ng-model="server.username" required>
                                                        <label>Username</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="md-form-group">
                                                        <div ng-if="!server.edit_password">
                                                            <input class="md-input" ng-model="server.password" disabled placeholder="*****">
                                                            <label>Password</label>
                                                            <a ng-click="server.edit_password = true" class="m-t-5 pull-right">
                                                                <small>Edit password</small>
                                                            </a>
                                                        </div>
                                                        <div ng-if="server.edit_password">
                                                            <input class="md-input" ng-model="server.password" required>
                                                            <label>Password</label>
                                                            <a ng-click="server.edit_password = false" ng-if="server.id" class="m-t-5 pull-right">
                                                                <small>Cancel edit password</small>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="md-form-group">
                                                        <input class="md-input" ng-model="server.path">
                                                        <label>Deploy path </label>
                                                        <a ng-click="explorePath()" class="m-t-5 pull-right">
                                                            <small>Explore path</small>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-8">
                                        <div ng-if="testingErrorMessage">
                                            Exception on connecting
                                            <pre>{{testingErrorMessage}}</pre>
                                        </div>

                                        <button type="submit" class="btn btn-primary btn-rounded m-r-10"
                                                ng-disabled="saving || form.$invalid">Save server
                                        </button>

                                        <button type="button" class="btn btn-default btn-rounded"
                                                ng-click="testConnection()"
                                                ng-disabled="testingConnection">{{testingConnection ? 'Connecting' : 'Test connection'}}
                                        </button>
                                        <span class="green m-l-10" ng-if="testingMessage">
                                            {{testingMessage}}
                                        </span>
                                        <div class="space10"></div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <br><br><br><br><br>
                </div>
            </div>
        </div>
    </div>
</div>