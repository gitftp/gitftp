{"version":3,"file":"default-src_app_project_servers_browse-server_browse-server_component_ts.js","mappings":"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","sources":["./src/app/project/servers/browse-server/browse-server.component.ts","./src/app/project/servers/browse-server/browse-server.component.html"],"sourcesContent":["import {Component, Inject, OnInit} from '@angular/core';\nimport {HelperService} from \"../../../helper.service\";\nimport {ApiResponse, ApiService} from \"../../../api.service\";\nimport {MAT_DIALOG_DATA, MatDialogRef} from \"@angular/material/dialog\";\nimport {ServerObject} from \"../server-create/server-create.component\";\n\n@Component({\n  selector: 'app-browse-server',\n  templateUrl: './browse-server.component.html',\n  styleUrls: ['./browse-server.component.scss']\n})\nexport class BrowseServerComponent implements OnInit {\n  constructor(\n    private helper: HelperService,\n    private apiService: ApiService,\n    public dialogRef: MatDialogRef<any>,\n    @Inject(MAT_DIALOG_DATA) public data: any\n  ) {\n    this.server = this.data.server;\n    this.path = this.server.path;\n    this.projectId = this.data.project_id;\n  }\n\n  server: ServerObject;\n  path: string = '';\n  projectId: string = '';\n\n  ngOnInit() {\n    this.call();\n  }\n\n  submit() {\n    this.dialogRef.close(this.path);\n  }\n\n  callTI: any;\n\n  callT() {\n    if (this.callTI) {\n      clearTimeout(this.callTI);\n      this.callTI = false;\n    }\n    this.callTI = setTimeout(() => {\n      this.call();\n    }, 400);\n  }\n\n  gotoPath(a: ServerBrowseFileObject) {\n    if (a.type == 'dir') {\n      this.path = a.path;\n      this.call();\n    }\n  }\n\n  goBack() {\n    let a = '../'\n    if (this.path) {\n      if (this.path.charAt(this.path.length - 1) != '/')\n        this.path += '/';\n      console.log(this.path);\n      if (this.path.substring(this.path.length - 3) == '../') {\n        a = this.path + a;\n        // this.path = a;\n      } else {\n        if (this.path.charAt(this.path.length - 1) == '/') {\n          a = this.path.substring(0, this.path.length - 1);\n        }\n        a = a.substring(0, a.lastIndexOf('/') + 1);\n      }\n    }\n    this.path = a;\n  }\n\n  files: ServerBrowseFileObject[] = [];\n  error: string = '';\n  calling: boolean = false;\n  projRoot: boolean = false;\n  message: string = '';\n\n  call(writeTest: boolean = false, pass = false) {\n    this.error = '';\n    let ser = Object.assign({}, this.server);\n    ser.path = this.path;\n    this.calling = true;\n    if (writeTest && !pass) {\n      // if (!confirm(\"\")) {\n      //   return;\n      // }\n      let dialog = this.helper.alert({\n        message: 'Gitftp will attempt to write & delete gitftp-write-test.txt file on this path',\n        type: 'alert',\n        buttons: ['Close', 'Confirm'],\n      });\n      dialog.afterClosed().subscribe({\n        next: (a: any) => {\n          if(a == 'Confirm'){\n            this.call(true, true);\n          }\n        }\n      })\n      return;\n    }\n    this.projRoot = false\n    this.message = '';\n    this.apiService.post('server/test', {\n      payload: ser,\n      write_test: writeTest,\n      project_id: this.projectId\n    })\n      .subscribe({\n        next: (res: ApiResponse) => {\n          this.calling = false;\n          console.log(res);\n          if (res.status) {\n            this.message = res.message;\n            this.files = res.data.list.map((a: any) => {\n              if (a.path.indexOf('gitftp.md') != -1) {\n                this.projRoot = true;\n              }\n              a.file_size = this.helper.bytes(a.file_size, 1);\n              return a;\n            });\n\n          } else {\n            this.error = res.message;\n          }\n\n        },\n        error: err => {\n          this.calling = false;\n          this.helper.alertError(err);\n        }\n      });\n  }\n}\n\nexport interface ServerBrowseFileObject {\n  type: string;\n  path: string;\n  file_size: number;\n  visibility: string;\n  last_modified: number;\n  mime_type?: any;\n  extra_metadata: any[];\n}\n","\n<mat-dialog-content style=\"padding-top: 0px;\">\n\n\n  <div style=\"padding: 0px 6px 10px;\n    min-width: 800px;position: relative\"\n       class=\"bootstrap-wrapper\">\n    <div class=\"container\" style=\"position: sticky; padding-top: 25px; top: 0;z-index: 2; background-color: white\">\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <h2 style=\"margin-top: 0px\">\n            Locate deploy path\n          </h2>\n          <mat-form-field appearance=\"outline\">\n<!--            <mat-label>Browse path</mat-label>-->\n            <mat-spinner [ngClass]=\"{\n            'hide': !calling\n            }\" matPrefix style=\"width: 50px;padding-left: 5px\" diameter=\"20\"></mat-spinner>\n            <input matInput\n                   (keyup.enter)=\"submit()\"\n                   (input)=\"callT()\"\n                   placeholder=\"Type path\"\n                   style=\"font-family: 'Lucida Console', monospace, sans-serif\"\n                   [(ngModel)]=\"path\">\n            <button matSuffix\n                    type=\"button\"\n                    mat-icon-button\n                    (click)=\"submit()\"\n                    matTooltip=\"Select path\"\n                    style=\"margin-right: 5px;\"\n                    color=\"primary\">\n              <mat-icon>check</mat-icon>\n            </button>\n          </mat-form-field>\n          <button type=\"button\" style=\"float: right;margin-top: -13px;\" mat-stroked-button color=\"primary\" (click)=\"call(true)\">\n            Test write permission\n          </button>\n          <p style=\"margin-top: 0px;color: {{error ? 'orangered' : ''}}\">{{message}} {{error}}&nbsp;\n          {{projRoot ? 'This is the Gitftp installation dir, Navigate up to get parent directories' : ''}}</p>\n\n        </div>\n      </div>\n    </div>\n\n    <div class=\"container\">\n      <div class=\"row\">\n        <div class=\"col-12\">\n          <div (click)=\"goBack();call();\"\n               class=\"f dir\">\n            <mat-icon>arrow_upward</mat-icon>\n            <span class=\"fp\">\n../ [Navigate up]\n          </span>\n          </div>\n          <div *ngFor=\"let f of files\"\n               (click)=\"gotoPath(f)\"\n               class=\"f {{f.type}}\">\n            <mat-icon *ngIf=\"f.type == 'dir'\">folder</mat-icon>\n            <mat-icon *ngIf=\"f.type == 'file'\">insert_drive_file</mat-icon>\n            <span class=\"fp\">\n\n          {{f.path}}\n          </span>\n            <span class=\"fs\">\n\n            {{f.file_size}}\n          </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</mat-dialog-content>\n"],"names":["MAT_DIALOG_DATA","i0","BrowseServerComponent","constructor","helper","apiService","dialogRef","data","server","path","projectId","project_id","ngOnInit","call","submit","close","callT","callTI","clearTimeout","setTimeout","gotoPath","a","type","goBack","charAt","length","console","log","substring","lastIndexOf","writeTest","pass","error","ser","Object","assign","calling","dialog","alert","message","buttons","afterClosed","subscribe","next","projRoot","post","payload","write_test","res","status","files","list","map","indexOf","file_size","bytes","err","alertError","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}